select p_category, sum(lo_ordtotalprice), count(*) from lineorder, part where p_partkey = lo_partkey group by 1 having sum(lo_ordtotalprice) > (select avg(lo_ordtotalprice) * 1.2  from lineorder  where lo_orderdate = 19940101 ) order by 1;                                                                                   
select lo_orderkey, lo_linenumber, lo_discount from lineorder lo_outer where lo_outer.lo_orderkey <= 500 and (lo_orderkey, lo_linenumber) in ( select lo_orderkey, max(lo_linenumber) from lineorder lo_subquery where lo_subquery.lo_orderkey <= 1000 group by 1 having max(lo_discount) = lo_outer.lo_discount ) order by 1, 2;
